#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <math.h>

#include <common/utils.h>


#include <common/model.h>
#include <qss/qss_model.h>
#include <classic/classic_model.h>

double __g;
double __L;
double __h_left;
double __h_right;
double __hu_left;
double __hu_right;

void
MOD_settings(SD_simulationSettings settings)
{
	 settings->debug = 0;
	 settings->parallel = FALSE;
	 settings->hybrid = FALSE;
	 settings->method = 4;
}

void
MOD_definition(int i, double *x, double *d, double *alg, double t, double *dx)
{
	int j = 0;
	int j30 = 0;
	int j31 = 0;
	j = i;
	if(j >=0 && j <= 499)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j) * 3] = (x[(j30+499) * 3]/sqrt(x[(j30-1) * 3])+x[(j30+500) * 3]/sqrt(x[(j30) * 3]))/(sqrt(x[(j30-1) * 3])+sqrt(x[(j30) * 3]));
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__g*(x[(j30-1) * 3]+x[(j30) * 3])/2.0);
		}
		alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j30+500) * 3]/sqrt(x[(j30) * 3])+x[(j30+501) * 3]/sqrt(x[(j30+1) * 3]))/(sqrt(x[(j30) * 3])+sqrt(x[(j30+1) * 3]));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__g*(x[(j30) * 3]+x[(j30+1) * 3])/2.0);
		}
		alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j30+500) * 3]*(x[(j30+500) * 3]-x[(j30+499) * 3]-(alg[(j30) * 3]-alg[(j30+500) * 3])*(x[(j30) * 3]-x[(j30-1) * 3]));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		j30 = j;
	if (j30 >= 1 && j30 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j30+1500) * 3]*(x[(j30+500) * 3]-x[(j30+501) * 3]+(alg[(j30+1000) * 3]+alg[(j30+1500) * 3])*(x[(j30+1) * 3]-x[(j30) * 3]));
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		dx[1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__L;
	}
	j = i-500;
	if(j >=0 && j <= 499)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j) * 3] = (x[(j31+499) * 3]/sqrt(x[(j31-1) * 3])+x[(j31+500) * 3]/sqrt(x[(j31) * 3]))/(sqrt(x[(j31-1) * 3])+sqrt(x[(j31) * 3]));
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__g*(x[(j31-1) * 3]+x[(j31) * 3])/2.0);
		}
		alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j31+500) * 3]/sqrt(x[(j31) * 3])+x[(j31+501) * 3]/sqrt(x[(j31+1) * 3]))/(sqrt(x[(j31) * 3])+sqrt(x[(j31+1) * 3]));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__g*(x[(j31) * 3]+x[(j31+1) * 3])/2.0);
		}
		alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j31+500) * 3]*(x[(j31+500) * 3]-x[(j31+499) * 3]-(alg[(j31) * 3]-alg[(j31+500) * 3])*(x[(j31) * 3]-x[(j31-1) * 3]));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		j31 = j;
	if (j31 >= 1 && j31 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j31+1500) * 3]*(x[(j31+500) * 3]-x[(j31+501) * 3]+(alg[(j31+1000) * 3]+alg[(j31+1500) * 3])*(x[(j31+1) * 3]-x[(j31) * 3]));
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		dx[1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__L;
	}
}

void
MOD_dependencies(int i, double *x, double *d, double *alg, double t, double *der, int *map)
{
	int j = 0;
	int j30 = 0;
	int j31 = 0;
	int j32 = 0;
	int j33 = 0;
	int j34 = 0;
	int j35 = 0;
	int j36 = 0;
	int j37 = 0;
	switch(i)
	{
		case 0:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
			alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
			alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			der[0 + 1] = -((alg[0]+alg[1500])*alg[7500]+(alg[3000]-alg[4500])*alg[9000])*500/__L;
			der[1500 + 1] = -(pow((alg[0]+alg[1500]),2.0)*alg[7500]+pow((alg[3000]-alg[4500]),2.0)*alg[9000])*500/__L;
			break;
		case 1:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
			alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
			alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			der[0 + 1] = -((alg[0]+alg[1500])*alg[7500]+(alg[3000]-alg[4500])*alg[9000])*500/__L;
			der[1500 + 1] = -(pow((alg[0]+alg[1500]),2.0)*alg[7500]+pow((alg[3000]-alg[4500]),2.0)*alg[9000])*500/__L;
			break;
		case 498:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
			alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
			alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			der[1497 + 1] = -((alg[1497]+alg[2997])*alg[8997]+(alg[4497]-alg[5997])*alg[10497])*500/__L;
			der[2997 + 1] = -(pow((alg[1497]+alg[2997]),2.0)*alg[8997]+pow((alg[4497]-alg[5997]),2.0)*alg[10497])*500/__L;
			break;
		case 499:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
			alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
			alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			der[1497 + 1] = -((alg[1497]+alg[2997])*alg[8997]+(alg[4497]-alg[5997])*alg[10497])*500/__L;
			der[2997 + 1] = -(pow((alg[1497]+alg[2997]),2.0)*alg[8997]+pow((alg[4497]-alg[5997]),2.0)*alg[10497])*500/__L;
			break;
		case 500:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
			alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
			alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			der[0 + 1] = -((alg[0]+alg[1500])*alg[7500]+(alg[3000]-alg[4500])*alg[9000])*500/__L;
			der[1500 + 1] = -(pow((alg[0]+alg[1500]),2.0)*alg[7500]+pow((alg[3000]-alg[4500]),2.0)*alg[9000])*500/__L;
			break;
		case 501:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
			alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
			alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			der[0 + 1] = -((alg[0]+alg[1500])*alg[7500]+(alg[3000]-alg[4500])*alg[9000])*500/__L;
			der[1500 + 1] = -(pow((alg[0]+alg[1500]),2.0)*alg[7500]+pow((alg[3000]-alg[4500]),2.0)*alg[9000])*500/__L;
			break;
		case 998:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
			alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
			alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			der[1497 + 1] = -((alg[1497]+alg[2997])*alg[8997]+(alg[4497]-alg[5997])*alg[10497])*500/__L;
			der[2997 + 1] = -(pow((alg[1497]+alg[2997]),2.0)*alg[8997]+pow((alg[4497]-alg[5997]),2.0)*alg[10497])*500/__L;
			break;
		case 999:
			alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
			alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
			alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
			alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
			alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
			alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
			alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
			alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
			alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
			alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
			alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
			alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
			der[1497 + 1] = -((alg[1497]+alg[2997])*alg[8997]+(alg[4497]-alg[5997])*alg[10497])*500/__L;
			der[2997 + 1] = -(pow((alg[1497]+alg[2997]),2.0)*alg[8997]+pow((alg[4497]-alg[5997]),2.0)*alg[10497])*500/__L;
			break;
	}
	j = i+1;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j) * 3] = (x[(j32+499) * 3]/sqrt(x[(j32-1) * 3])+x[(j32+500) * 3]/sqrt(x[(j32) * 3]))/(sqrt(x[(j32-1) * 3])+sqrt(x[(j32) * 3]));
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__g*(x[(j32-1) * 3]+x[(j32) * 3])/2.0);
		}
		alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j32+500) * 3]/sqrt(x[(j32) * 3])+x[(j32+501) * 3]/sqrt(x[(j32+1) * 3]))/(sqrt(x[(j32) * 3])+sqrt(x[(j32+1) * 3]));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__g*(x[(j32) * 3]+x[(j32+1) * 3])/2.0);
		}
		alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j32+500) * 3]*(x[(j32+500) * 3]-x[(j32+499) * 3]-(alg[(j32) * 3]-alg[(j32+500) * 3])*(x[(j32) * 3]-x[(j32-1) * 3]));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		j32 = j;
	if (j32 >= 1 && j32 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j32+1500) * 3]*(x[(j32+500) * 3]-x[(j32+501) * 3]+(alg[(j32+1000) * 3]+alg[(j32+1500) * 3])*(x[(j32+1) * 3]-x[(j32) * 3]));
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__L;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__L;
	}
	j = i;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j) * 3] = (x[(j33+499) * 3]/sqrt(x[(j33-1) * 3])+x[(j33+500) * 3]/sqrt(x[(j33) * 3]))/(sqrt(x[(j33-1) * 3])+sqrt(x[(j33) * 3]));
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__g*(x[(j33-1) * 3]+x[(j33) * 3])/2.0);
		}
		alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j33+500) * 3]/sqrt(x[(j33) * 3])+x[(j33+501) * 3]/sqrt(x[(j33+1) * 3]))/(sqrt(x[(j33) * 3])+sqrt(x[(j33+1) * 3]));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__g*(x[(j33) * 3]+x[(j33+1) * 3])/2.0);
		}
		alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j33+500) * 3]*(x[(j33+500) * 3]-x[(j33+499) * 3]-(alg[(j33) * 3]-alg[(j33+500) * 3])*(x[(j33) * 3]-x[(j33-1) * 3]));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		j33 = j;
	if (j33 >= 1 && j33 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j33+1500) * 3]*(x[(j33+500) * 3]-x[(j33+501) * 3]+(alg[(j33+1000) * 3]+alg[(j33+1500) * 3])*(x[(j33+1) * 3]-x[(j33) * 3]));
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__L;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__L;
	}
	j = i-1;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j) * 3] = (x[(j34+499) * 3]/sqrt(x[(j34-1) * 3])+x[(j34+500) * 3]/sqrt(x[(j34) * 3]))/(sqrt(x[(j34-1) * 3])+sqrt(x[(j34) * 3]));
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__g*(x[(j34-1) * 3]+x[(j34) * 3])/2.0);
		}
		alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j34+500) * 3]/sqrt(x[(j34) * 3])+x[(j34+501) * 3]/sqrt(x[(j34+1) * 3]))/(sqrt(x[(j34) * 3])+sqrt(x[(j34+1) * 3]));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__g*(x[(j34) * 3]+x[(j34+1) * 3])/2.0);
		}
		alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j34+500) * 3]*(x[(j34+500) * 3]-x[(j34+499) * 3]-(alg[(j34) * 3]-alg[(j34+500) * 3])*(x[(j34) * 3]-x[(j34-1) * 3]));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		j34 = j;
	if (j34 >= 1 && j34 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j34+1500) * 3]*(x[(j34+500) * 3]-x[(j34+501) * 3]+(alg[(j34+1000) * 3]+alg[(j34+1500) * 3])*(x[(j34+1) * 3]-x[(j34) * 3]));
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__L;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__L;
	}
	j = i-499;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j) * 3] = (x[(j35+499) * 3]/sqrt(x[(j35-1) * 3])+x[(j35+500) * 3]/sqrt(x[(j35) * 3]))/(sqrt(x[(j35-1) * 3])+sqrt(x[(j35) * 3]));
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__g*(x[(j35-1) * 3]+x[(j35) * 3])/2.0);
		}
		alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j35+500) * 3]/sqrt(x[(j35) * 3])+x[(j35+501) * 3]/sqrt(x[(j35+1) * 3]))/(sqrt(x[(j35) * 3])+sqrt(x[(j35+1) * 3]));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__g*(x[(j35) * 3]+x[(j35+1) * 3])/2.0);
		}
		alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j35+500) * 3]*(x[(j35+500) * 3]-x[(j35+499) * 3]-(alg[(j35) * 3]-alg[(j35+500) * 3])*(x[(j35) * 3]-x[(j35-1) * 3]));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		j35 = j;
	if (j35 >= 1 && j35 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j35+1500) * 3]*(x[(j35+500) * 3]-x[(j35+501) * 3]+(alg[(j35+1000) * 3]+alg[(j35+1500) * 3])*(x[(j35+1) * 3]-x[(j35) * 3]));
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__L;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__L;
	}
	j = i-500;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j) * 3] = (x[(j36+499) * 3]/sqrt(x[(j36-1) * 3])+x[(j36+500) * 3]/sqrt(x[(j36) * 3]))/(sqrt(x[(j36-1) * 3])+sqrt(x[(j36) * 3]));
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__g*(x[(j36-1) * 3]+x[(j36) * 3])/2.0);
		}
		alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j36+500) * 3]/sqrt(x[(j36) * 3])+x[(j36+501) * 3]/sqrt(x[(j36+1) * 3]))/(sqrt(x[(j36) * 3])+sqrt(x[(j36+1) * 3]));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__g*(x[(j36) * 3]+x[(j36+1) * 3])/2.0);
		}
		alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j36+500) * 3]*(x[(j36+500) * 3]-x[(j36+499) * 3]-(alg[(j36) * 3]-alg[(j36+500) * 3])*(x[(j36) * 3]-x[(j36-1) * 3]));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		j36 = j;
	if (j36 >= 1 && j36 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j36+1500) * 3]*(x[(j36+500) * 3]-x[(j36+501) * 3]+(alg[(j36+1000) * 3]+alg[(j36+1500) * 3])*(x[(j36+1) * 3]-x[(j36) * 3]));
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__L;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__L;
	}
	j = i-501;
	if(j >=1 && j <= 498)
	{
		alg[0] = (x[1500]/sqrt(x[0])+x[1500]/sqrt(x[0]))/(sqrt(x[0])+sqrt(x[0]));
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j) * 3] = (x[(j37+499) * 3]/sqrt(x[(j37-1) * 3])+x[(j37+500) * 3]/sqrt(x[(j37) * 3]))/(sqrt(x[(j37-1) * 3])+sqrt(x[(j37) * 3]));
		}
		alg[1497] = (x[2994]/sqrt(x[1494])+x[2997]/sqrt(x[1497]))/(sqrt(x[1494])+sqrt(x[1497]));
		alg[1500] = sqrt(__g*(x[0]+x[0])/2.0);
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+500) * 3] = sqrt(__g*(x[(j37-1) * 3]+x[(j37) * 3])/2.0);
		}
		alg[2997] = sqrt(__g*(x[1494]+x[1497])/2.0);
		alg[3000] = (x[1500]/sqrt(x[0])+x[1503]/sqrt(x[3]))/(sqrt(x[0])+sqrt(x[3]));
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+1000) * 3] = (x[(j37+500) * 3]/sqrt(x[(j37) * 3])+x[(j37+501) * 3]/sqrt(x[(j37+1) * 3]))/(sqrt(x[(j37) * 3])+sqrt(x[(j37+1) * 3]));
		}
		alg[4497] = (x[2997]/sqrt(x[1497])+x[2997]/sqrt(x[1497]))/(sqrt(x[1497])+sqrt(x[1497]));
		alg[4500] = sqrt(__g*(x[0]+x[3])/2.0);
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+1500) * 3] = sqrt(__g*(x[(j37) * 3]+x[(j37+1) * 3])/2.0);
		}
		alg[5997] = sqrt(__g*(x[1497]+x[1497])/2.0);
		alg[7500] = 5.000000000000000000000000e-01/alg[1500]*(x[1500]-x[1500]-(alg[0]-alg[1500])*(x[0]-x[0]));
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+2500) * 3] = 5.000000000000000000000000e-01/alg[(j37+500) * 3]*(x[(j37+500) * 3]-x[(j37+499) * 3]-(alg[(j37) * 3]-alg[(j37+500) * 3])*(x[(j37) * 3]-x[(j37-1) * 3]));
		}
		alg[8997] = 5.000000000000000000000000e-01/alg[2997]*(x[2997]-x[2994]-(alg[1497]-alg[2997])*(x[1494]-x[1497]));
		alg[9000] = 5.000000000000000000000000e-01/alg[4500]*(x[1500]-x[1503]+(alg[3000]+alg[4500])*(x[3]-x[0]));
		j37 = j;
	if (j37 >= 1 && j37 <= 498)
	{
		alg[(j+3000) * 3] = 5.000000000000000000000000e-01/alg[(j37+1500) * 3]*(x[(j37+500) * 3]-x[(j37+501) * 3]+(alg[(j37+1000) * 3]+alg[(j37+1500) * 3])*(x[(j37+1) * 3]-x[(j37) * 3]));
		}
		alg[10497] = 5.000000000000000000000000e-01/alg[5997]*(x[2997]-x[2997]+(alg[4497]+alg[5997])*(x[1497]-x[1497]));
		der[(j) * 3 + 1] = -((alg[(j) * 3]+alg[(j+500) * 3])*alg[(j+2500) * 3]+(alg[(j+1000) * 3]-alg[(j+1500) * 3])*alg[(j+3000) * 3])*500/__L;
		der[(j+500) * 3 + 1] = -(pow((alg[(j) * 3]+alg[(j+500) * 3]),2.0)*alg[(j+2500) * 3]+pow((alg[(j+1000) * 3]-alg[(j+1500) * 3]),2.0)*alg[(j+3000) * 3])*500/__L;
	}
}

void
MOD_output(int i, double *x, double *d, double *alg, double t, double *out)
{
	switch(i)
	{
		case 0:
			out[0] = x[744];
			return;
	}
}

void
QSS_initializeDataStructs(QSS_simulator simulator)
{
	int *outputs = (int*)malloc(1*sizeof(int));
	int *states = (int*)malloc(1000*sizeof(int));
	int i38;
	int i39;
	int i;
	int j = 0;
	simulator->data = QSS_Data(1000,0,0,0,4000,"shallow");
QSS_data modelData = simulator->data;

	// Allocate main data structures.
	__g = 1.000000000000000000000000e+00;
	__L = 1.000000000000000000000000e+01;
	__h_left = 3.000000000000000000000000e+00;
	__h_right = 1.000000000000000000000000e+00;
	__hu_left = 0.000000000000000000000000e+00;
	__hu_right = 0.000000000000000000000000e+00;
	// Initialize model code.
	for(i38 = 0; i38 <= 249; i38++)
	{
		modelData->x[(i38) * 3] = 3.000000000000000000000000e+00;
	}
	for(i39 = 250; i39 <= 499; i39++)
	{
		modelData->x[(i39) * 3] = 1.000000000000000000000000e+00;
	}
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[499]++;
	modelData->nDS[499]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i]++;
	}
	modelData->nDS[499]++;
	modelData->nDS[499]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[999]++;
	modelData->nDS[999]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nDS[i+500]++;
	}
	modelData->nDS[999]++;
	modelData->nDS[999]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i-1]++;
	}
	modelData->nSD[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i]++;
	}
	modelData->nSD[1]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+1]++;
	}
	modelData->nSD[498]++;
	modelData->nSD[499]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+499]++;
	}
	modelData->nSD[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+500]++;
	}
	modelData->nSD[501]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+501]++;
	}
	modelData->nSD[998]++;
	modelData->nSD[999]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i-1]++;
	}
	modelData->nSD[0]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i]++;
	}
	modelData->nSD[1]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+1]++;
	}
	modelData->nSD[498]++;
	modelData->nSD[499]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+499]++;
	}
	modelData->nSD[500]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+500]++;
	}
	modelData->nSD[501]++;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->nSD[i+501]++;
	}
	modelData->nSD[998]++;
	modelData->nSD[999]++;
	QSS_allocDataMatrix(modelData);
	// Initialize model data.
	// Initialize model time.
		cleanVector(states,0,1000);

	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i-1;
	}
	modelData->DS[0][states[0]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i;
	}
	modelData->DS[0][states[0]++] = 1;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i+1;
	}
	modelData->DS[499][states[499]++] = 498;
	modelData->DS[499][states[499]++] = 499;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i+499;
	}
	modelData->DS[0][states[0]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i+500;
	}
	modelData->DS[0][states[0]++] = 501;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i][states[i]++] = i+501;
	}
	modelData->DS[499][states[499]++] = 998;
	modelData->DS[499][states[499]++] = 999;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i-1;
	}
	modelData->DS[500][states[500]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i;
	}
	modelData->DS[500][states[500]++] = 1;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i+1;
	}
	modelData->DS[999][states[999]++] = 498;
	modelData->DS[999][states[999]++] = 499;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i+499;
	}
	modelData->DS[500][states[500]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i+500;
	}
	modelData->DS[500][states[500]++] = 501;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->DS[i+500][states[i+500]++] = i+501;
	}
	modelData->DS[999][states[999]++] = 998;
	modelData->DS[999][states[999]++] = 999;
		cleanVector(states,0,1000);

	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i-1][states[i-1]++] = i;
	}
	modelData->SD[0][states[0]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i][states[i]++] = i;
	}
	modelData->SD[1][states[1]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+1][states[i+1]++] = i;
	}
	modelData->SD[498][states[498]++] = 499;
	modelData->SD[499][states[499]++] = 499;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+499][states[i+499]++] = i;
	}
	modelData->SD[500][states[500]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+500][states[i+500]++] = i;
	}
	modelData->SD[501][states[501]++] = 0;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+501][states[i+501]++] = i;
	}
	modelData->SD[998][states[998]++] = 499;
	modelData->SD[999][states[999]++] = 499;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i-1][states[i-1]++] = i+500;
	}
	modelData->SD[0][states[0]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i][states[i]++] = i+500;
	}
	modelData->SD[1][states[1]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+1][states[i+1]++] = i+500;
	}
	modelData->SD[498][states[498]++] = 999;
	modelData->SD[499][states[499]++] = 999;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+499][states[i+499]++] = i+500;
	}
	modelData->SD[500][states[500]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+500][states[i+500]++] = i+500;
	}
	modelData->SD[501][states[501]++] = 500;
	for ( i = 1; i <= 498; i++) 
	{
	modelData->SD[i+501][states[i+501]++] = i+500;
	}
	modelData->SD[998][states[998]++] = 999;
	modelData->SD[999][states[999]++] = 999;
	simulator->time = QSS_Time(1000,0,0,0,ST_Binary,NULL);

	simulator->output = SD_Output("shallow",1,0,1000,NULL,0,0,CI_Step,SD_Memory,MOD_output);
SD_output modelOutput = simulator->output;

		modelOutput->nOS[0] = 1;
		modelOutput->nSO[248]++;
	SD_allocOutputMatrix(modelOutput,1000,0);
		cleanVector(states,0,1000);

		cleanVector(outputs,0,1);

		sprintf(modelOutput->variable[0].name,"h[249]");
		cleanVector(outputs,0,1);

		modelOutput->SO[248][states[248]++] = 0;
		modelOutput->OS[0][outputs[0]++] = 248;
	simulator->model = QSS_Model(MOD_definition,MOD_dependencies,NULL,NULL,NULL);
	free(outputs);
	free(states);
}

void
CLC_initializeDataStructs (CLC_simulator simulator)
{
}
